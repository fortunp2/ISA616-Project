p <- c("readr", "tidyverse", "corrplot")
install.packages(p)
library(readr)
# loading in the data
beach <- read.csv("BeachTan/BeachTan.csv")
library(tidyverse)
summary(beach)
head(beach)
beachUpgrade <- beach %>%
select(-RetailRevenue)
# Creating a linear model based on training data
modelRetail <- lm(RetailRevenue ~ ., data = beach.train)
options(scipen = 999)
# Creating linear model 1 based on training data
modelRetail <- lm(RetailRevenue ~ ., data = beach)
# Summary of model 1
summary(model.train)
# Summary of model 1
summary(model.train)
# Summary of model 1
summary(model.train)
# Summary of model 1
summary(model.train)
# Summary of model 1
summary(modelRetail)
summary(modelRetail)
options(scipen = 999)
# Summary of model 1
summary(modelRetail)
summary(modelRetail)
# Creating linear model 1 based on training data
modelRetail <- lm(RetailRevenue ~ ., data = beach)
# Creating linear model 1 based on training data
modelRetail <- lm(RetailRevenue ~ ., data = beach)
options(scipen = 999)
beachUpgrade <- beach %>%
select(-RetailRevenue)
# recoding the following variables to factors
beach$UIDStoreLocation <- as.factor(beach$UIDStoreLocation)
beach$Gender <- as.factor(beach$Gender)
beach$DateJoined <- as.Date(beach$DateJoined, "%m/%d/%Y")
beach$MembershipType <- as.factor(beach$MembershipType)
beach$MembershipLevel <- as.factor(beach$MembershipLevel)
# Recoding some factors so they make sense
beach$Gender <- recode_factor(beach$Gender,
"0" = "Female",
"1" = "Male")
beach$MembershipType <- recode_factor(beach$MembershipType,
"0" = "Non-Member",
"1" = "Monthly",
"2" = "Annual")
beach$MembershipLevel <- recode_factor(beach$MembershipLevel,
"0" = "Non-Member",
"1" = "Fast",
"2" = "Faster",
"3" = "Fastest",
"4" = "Instant")
# Removing variables that don't need to be in model
beach <- beach %>%
select(-UIDClient, -DateJoined)
# Removing rows that which don't have a DateJoined (their DaysSinceJoined
# attribute had over 10,000 days in it)
beach <- beach %>%
filter(DaysSinceJoined < 10000)
beach <- na.omit(beach)
str(beach)
ggplot(beach, aes(x = MembershipType, y = RetailRevenue)) +
geom_col()
library(DataExplorer)
plot_bar(beach)
plot_histogram(beach)
plot_scatterplot(beach)
library(corrplot)
nums <- unlist(lapply(beach, is.numeric))
M<-cor(beach[,nums], use="complete.obs")
corrplot(M, method="color")
# Creating dummy variables for factors in the data frame
dum1 <- model.matrix(~0 + UIDStoreLocation, data = beach)
dum1 <- as.data.frame(dum1)
dum2 <- model.matrix(~0 + Gender, data = beach)
dum2 <- as.data.frame(dum2)
dum3 <- model.matrix(~0 + MembershipType, data = beach)
dum3 <- as.data.frame(dum3)
dum4 <- model.matrix(~0 + MembershipLevel, data = beach)
dum4 <- as.data.frame(dum4)
beach <- cbind(beach, dum1, dum2, dum3, dum4)
beach <- beach %>%
select(-UIDStoreLocation, -Gender, -MembershipType, -MembershipLevel,
-UIDStoreLocation10, -GenderMale, -MembershipTypeAnnual, -MembershipLevelInstant)
beach$UIDStoreLocation1 <- as.factor(beach$UIDStoreLocation1)
beach$UIDStoreLocation2 <- as.factor(beach$UIDStoreLocation2)
beach$UIDStoreLocation3 <- as.factor(beach$UIDStoreLocation3)
beach$UIDStoreLocation4 <- as.factor(beach$UIDStoreLocation4)
beach$UIDStoreLocation5 <- as.factor(beach$UIDStoreLocation5)
beach$UIDStoreLocation6 <- as.factor(beach$UIDStoreLocation6)
beach$UIDStoreLocation7 <- as.factor(beach$UIDStoreLocation7)
beach$UIDStoreLocation8 <- as.factor(beach$UIDStoreLocation8)
beach$UIDStoreLocation9 <- as.factor(beach$UIDStoreLocation9)
beach$GenderFemale <- as.factor(beach$GenderFemale)
beach$`MembershipTypeNon-Member` <- as.factor(beach$`MembershipTypeNon-Member`)
beach$MembershipTypeMonthly <- as.factor(beach$MembershipTypeMonthly)
beach$MembershipLevelFast <- as.factor(beach$MembershipLevelFast)
beach$MembershipLevelFaster <- as.factor(beach$MembershipLevelFaster)
beach$MembershipLevelFastest <- as.factor(beach$MembershipLevelFastest)
beach$`MembershipLevelNon-Member` <- as.factor(beach$`MembershipLevelNon-Member`)
beachUpgrade <- beach %>%
select(-RetailRevenue)
# Creating linear model 1 based on training data
modelRetail <- lm(RetailRevenue ~ ., data = beach)
options(scipen = 999)
summary(modelRetail)
beachRetail <- beach %>%
select(-UpgradeRevenue)
# Creating linear model 1 based on training data
modelRetail <- lm(RetailRevenue ~ ., data = beachRetail)
options(scipen = 999)
summary(modelRetail)
summary(modelUpgrade)
# Creating linear model 2
modelUpgrade <- lm(UpgradeRevenue ~ ., data = beachUpgrade)
summary(modelUpgrade)
beachUpgrade <- beach %>%
select(-RetailRevenue, - `MembershipTypeNon-Member`, `MembershipLevelNon-Member`)
# Creating linear model 2
modelUpgrade <- lm(UpgradeRevenue ~ ., data = beachUpgrade)
summary(modelUpgrade)
beachUpgrade <- beach %>%
select(-RetailRevenue, -`MembershipTypeNon-Member`, -`MembershipLevelNon-Member`)
# Creating linear model 2
modelUpgrade <- lm(UpgradeRevenue ~ ., data = beachUpgrade)
summary(modelUpgrade)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
beach <- read.csv("BeachTan/BeachTan.csv")
library(readr)
beach <- read.csv("BeachTan/BeachTan.csv")
summary(beach)
library(readr)
beach <- read.csv("BeachTan/BeachTan.csv")
str(beach)
# loading in the data
beach <- read.csv("BeachTan/BeachTan.csv")
# loading in the data
beach <- read.csv("BeachTan/BeachTan.csv")
view(beach)
View(beach)
knitr::opts_chunk$set(echo = TRUE)
# Loading the library that reads in csv files
library(readr)
# Reading in the Beach Tan dataset
beach <- read.csv("BeachTan/BeachTan.csv")
# Viewing the head of the data
head(beach)
# Viewing the structure of the data
str(beach)
# Loading the DataExplorer package
library(DataExplorer)
# Distribution of the continuous variables
plot_histogram(beach)
# changing the following numeric variables to factors
beach$UIDStoreLocation <- as.factor(beach$UIDStoreLocation)
beach$Gender <- as.factor(beach$Gender)
beach$MembershipType <- as.factor(beach$MembershipType)
beach$MembershipLevel <- as.factor(beach$MembershipLevel)
# changing the following character variable to a date
beach$DateJoined <- as.Date(beach$DateJoined, "%m/%d/%Y")
beach$Gender <- recode_factor(beach$Gender,
"0" = "Female",
"1" = "Male")
# The tidyverse package contains a variaty of packages that will assist us in our analysis.
library(tidyverse)
beach$Gender <- recode_factor(beach$Gender,
"0" = "Female",
"1" = "Male")
beach$MembershipType <- recode_factor(beach$MembershipType,
"0" = "Non-Member",
"1" = "Monthly",
"2" = "Annual")
beach$MembershipLevel <- recode_factor(beach$MembershipLevel,
"0" = "Non-Member",
"1" = "Fast",
"2" = "Faster",
"3" = "Fastest",
"4" = "Instant")
# Loading the DataExplorer package
library(DataExplorer)
# Distribution of the continuous variables
plot_histogram(beach)
max(beach$DaysSinceJoined)
# The `filter` function belongs to the dplyr package
filter(beach, DaysSinceJoined > 40000)
midwest
midwest$state
filter(midwest, state = "KS")
unique(midwest$state)
plot_missing(beach)
# Loading the DataExplorer package
library(DataExplorer)
plot_missing(beach)
beach <- beach %>%
filter(DateJoined > 40000)
# Loading the library that reads in csv files
library(readr)
# Reading in the Beach Tan dataset
beach <- read.csv("BeachTan/BeachTan.csv")
# Viewing the head of the data
head(beach)
# changing the following numeric variables to factors
beach$UIDStoreLocation <- as.factor(beach$UIDStoreLocation)
beach$Gender <- as.factor(beach$Gender)
beach$MembershipType <- as.factor(beach$MembershipType)
beach$MembershipLevel <- as.factor(beach$MembershipLevel)
# changing the following character variable to a date
beach$DateJoined <- as.Date(beach$DateJoined, "%m/%d/%Y")
# Loading in the tidyverse package
library(tidyverse)
# Recoding the factors in Gender
beach$Gender <- recode_factor(beach$Gender,
"0" = "Female",
"1" = "Male")
# Recoding the factors in MemebershipType
beach$MembershipType <- recode_factor(beach$MembershipType,
"0" = "Non-Member",
"1" = "Monthly",
"2" = "Annual")
# Recoding the factors in MembershipLevel
beach$MembershipLevel <- recode_factor(beach$MembershipLevel,
"0" = "Non-Member",
"1" = "Fast",
"2" = "Faster",
"3" = "Fastest",
"4" = "Instant")
# The piping operator (%>%) and `select` functions belong to the dplyr package
beach <- beach %>%
select(-UIDClient)
beach <- beach %>%
filter(DaysSinceJoined > 40000)
hist(beach$DaysSinceJoined)
beach <- beach %>%
filter(DaysSinceJoined < 40000)
hist(beach$DaysSinceJoined)
# Loading the library that reads in csv files
library(readr)
# Reading in the Beach Tan dataset
beach <- read.csv("BeachTan/BeachTan.csv")
# Viewing the head of the data
head(beach)
# changing the following numeric variables to factors
beach$UIDStoreLocation <- as.factor(beach$UIDStoreLocation)
beach$Gender <- as.factor(beach$Gender)
beach$MembershipType <- as.factor(beach$MembershipType)
beach$MembershipLevel <- as.factor(beach$MembershipLevel)
# changing the following character variable to a date
beach$DateJoined <- as.Date(beach$DateJoined, "%m/%d/%Y")
# Loading in the tidyverse package
library(tidyverse)
# Recoding the factors in Gender
beach$Gender <- recode_factor(beach$Gender,
"0" = "Female",
"1" = "Male")
# Recoding the factors in MemebershipType
beach$MembershipType <- recode_factor(beach$MembershipType,
"0" = "Non-Member",
"1" = "Monthly",
"2" = "Annual")
# Recoding the factors in MembershipLevel
beach$MembershipLevel <- recode_factor(beach$MembershipLevel,
"0" = "Non-Member",
"1" = "Fast",
"2" = "Faster",
"3" = "Fastest",
"4" = "Instant")
# Loading the DataExplorer package
library(DataExplorer)
plot_missing(beach)
# Distribution of the continuous variables
plot_histogram(beach)
# The piping operator (%>%) and `select` functions belong to the dplyr package
beach <- beach %>%
select(-UIDClient)
beach <- beach %>%
filter(DaysSinceJoined < 40000)
hist(beach$DaysSinceJoined)
# Distribution of factors
plot_bar(beach)
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col()
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col()
ggplot(beach, aes(x = reorder(UIDStoreLocation, -RetailRevenue), y = RetailRevenue)) +
geom_col()
ggplot(beach, aes(x = reorder(UIDStoreLocation, -RetailRevenue), y = RetailRevenue)) +
geom_col()
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col()
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c(2, 10, 3, 8, 5, 9, 6, 1, 4, 7))
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c(2, 10, 3, 8, 5, 9, 6, 1, 4, 7),
labels = c("2", "10", "3", "8", "5", "9", "6", "1", "4", "7"))
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(breaks = c(2, 10, 3, 8, 5, 9, 6, 1, 4, 7),
labels = c("2", "10", "3", "8", "5", "9", "6", "1", "4", "7"))
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(breaks = c(2, 10, 3, 8, 5, 9, 6, 1, 4, 7))
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c(2, 10, 3, 8, 5, 9, 6, 1, 4, 7),
lables = c(1 = "2", 2 = "10", 3 = "3", 4 = "8", 5 = "5", 6 = "9",
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c(2, 10, 3, 8, 5, 9, 6, 1, 4, 7))
beach1 <- beach
beach1$UIDStoreLocation <- recode_factor(beach$UIDStoreLocation,
"1" = "A",
"2" = "B",
"3" = "C",
"4" = "D",
"5" = "E",
"6" = "F",
"7" = "G",
"8" = "H",
"9" = "I",
"10" = "J")
ggplot(beach1, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col()
ggplot(beach1, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c("B", "J", "C", "H", "E", "I", "A", "F", "D", "G"))
sum(beach1$RetailRevenue)
aggregate(RetailRevenue~UIDStoreLocation, beach1, sum)
aggregate(RetailRevenue~MembershipLevel, beach1, sum)
aggregate(RetailRevenue~MembershipType, beach1, sum)
aggregate(RetailRevenue~UIDStoreLocation, beach1, average)
aggregate(RetailRevenue~UIDStoreLocation, beach1, avg)
aggregate(RetailRevenue~UIDStoreLocation, beach1, mean)
ggplot(beach1, aes(x = UIDStoreLocation, y = mean(RetailRevenue))) +
geom_col() +
scale_x_discrete(limits = c("B", "J", "C", "H", "E", "I", "A", "F", "D", "G"))
ggplot(beach1, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c("B", "J", "C", "H", "E", "I", "A", "F", "D", "G"))
aggregate(RetailRevenue~MembershipType, beach1, sum)
aggregate(UpgradeRevenue~MembershipLevel)
aggregate(UpgradeRevenue~MembershipLevel, beach1, sum)
aggregate(UpgradeRevenue~MembershipType, beach1, sum)
aggregate(UIDStoreLocation, beach1, count)
beach1 <-read.csv("BeachTan/BeachTan.csv")
aggregate(UIDStoreLocation, beach1, count)
aggregate(UIDStoreLocation, beach, count)
count(UIDStoreLocation)
count(beach1$UIDStoreLocation)
summary(beach1$UIDStoreLocation)
str(beach1$UIDStoreLocation)
count(as.factor(beach1$UIDStoreLocation))
str(as.factor(beach1$UIDStoreLocation))
summary(as.factor(beach1$UIDStoreLocation))
aggregate(RetailRevenue~UIDStoreLocation, beach1, sum)
a <- c("A", "B", "C", "D", "E", "F", "G", "H", "I", "J")
b <- c(814, 1515, 1092, 886, 1197, 778, 848, 1282, 1034, 1595)
c <- c(45279.83, 96623.01, 63807.34, 42244.73, 57229.70, 45162.91, 13968.67, 60553.72, 55214.93, 72635.85)
d <- b/c
d <- c/b
plot(a, d)
plot(a ~ d)
a
abcd <- as.data.frame(c(a, b, c, d))
abcd
a
d
aggregate(RetailRevenue~UIDStoreLocation, beach1, mean)
avg <- aggregate(RetailRevenue~UIDStoreLocation, beach1, mean)
plot(avg$UIDStoreLocation, avg$RetailRevenue)
barplot(avg$UIDStoreLocation, avg$RetailRevenue)
ggplot(avg, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_bar()
ggplot(avg, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col()
avg <- aggregate(RetailRevenue~as.factor(UIDStoreLocation), beach1, mean)
ggplot(avg, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col()
ggplot(avg, aes(x = as.factor(UIDStoreLocation), y = RetailRevenue)) +
geom_col()
avg <- aggregate(RetailRevenue~UIDStoreLocation, beach1, mean)
ggplot(avg, aes(x = as.factor(UIDStoreLocation), y = RetailRevenue)) +
geom_col()
beach1$UIDStoreLocation <- as.factor(beach1$UIDStoreLocation)
avg <- aggregate(RetailRevenue~UIDStoreLocation, beach1, mean)
ggplot(avg, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col()
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c("B", "J", "C", "H", "E", "I", "A", "F", "D", "G"))
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c("B", "J", "C", "H", "E", "I", "A", "F", "D", "G"))
# Loading in the tidyverse package
library(tidyverse)
# Recoding the factors in Gender
beach$Gender <- recode_factor(beach$Gender,
"0" = "Female",
"1" = "Male")
# Recoding the factors in MemebershipType
beach$MembershipType <- recode_factor(beach$MembershipType,
"0" = "Non-Member",
"1" = "Monthly",
"2" = "Annual")
# Recoding the factors in MembershipLevel
beach$MembershipLevel <- recode_factor(beach$MembershipLevel,
"0" = "Non-Member",
"1" = "Fast",
"2" = "Faster",
"3" = "Fastest",
"4" = "Instant")
# Recoding the factors in UIDStoreLocation
beach$UIDStoreLocation <- recode_factor(beach$UIDStoreLocation,
"1" = "A",
"2" = "B",
"3" = "C",
"4" = "D",
"5" = "E",
"6" = "F",
"7" = "G",
"8" = "H",
"9" = "I",
"10" = "J")
ggplot(beach, aes(x = UIDStoreLocation, y = RetailRevenue)) +
geom_col() +
scale_x_discrete(limits = c("B", "J", "C", "H", "E", "I", "A", "F", "D", "G"))
# Distribution of factors
plot_bar(beach)
beach <- beach %>%
select(-DateJoined)
# Distribution of factors
plot_bar(beach)
# The `na_omit` function belongs to the stats package.
beach <- na.omit(beach)
plot_missing(beach)
ggplot(beach1, aes(x = DaysSinceJoined, y = RetailRevenue)) +
geom_line()
ggplot(beach, aes(x = DaysSinceJoined, y = RetailRevenue)) +
geom_line()
